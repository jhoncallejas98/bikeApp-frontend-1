<div class="container py-4">
  <h1 class="mb-4 text-primary text-center">Detalle de estación</h1>
  <div *ngIf="loading" class="alert alert-info text-center">Cargando datos...</div>
  <div *ngIf="error" class="alert alert-danger text-center">{{ error }}</div>
  <div *ngIf="estacion && !loading">
    <div class="card mb-4 shadow-sm">
      <div class="card-body">
        <h2 class="card-title mb-2"><span class="me-2">📍</span>{{ estacion.name }}</h2>
        <p class="mb-1"><span class="me-2">📌</span><b>Ubicación:</b> {{ estacion.location }}</p>
        <p class="mb-1"><span class="me-2">🏟️</span><b>Capacidad:</b> {{ estacion.capacity }}</p>
        <p><span class="me-2">🚲</span><b>Bicicletas disponibles:</b>
          <span class="badge bg-success ms-2">{{ estacion.availableBikes }}</span>
        </p>
      </div>
    </div>
    <div class="card mb-4 shadow-sm">
      <div class="card-body">
        <h3 class="card-title mb-3"><span class="me-2">🚲</span>Bicicletas disponibles</h3>
        <div *ngIf="bicicletas.length === 0" class="alert alert-warning text-center">
          <span class="display-6">🚳</span>
          <span>No hay bicicletas disponibles en esta estación.</span>
        </div>
        <ul *ngIf="bicicletas.length > 0" class="list-group mb-0">
          <li *ngFor="let bici of bicicletas" class="list-group-item d-flex justify-content-between align-items-center">
            <span><span class="me-2">#</span>{{ bici.serial }}</span>
            <span class="badge bg-success">{{ bici.status }}</span>
          </li>
        </ul>
      </div>
    </div>
    <div class="row g-4">
      <div class="col-md-6">
        <div class="card shadow-sm">
          <div class="card-body">
            <h4 class="card-title mb-3"><span class="me-2">🛒</span>Alquilar bicicleta</h4>
            <form [formGroup]="alquilerForm" (ngSubmit)="alquilarBicicleta()" novalidate>
              <div class="mb-3">
                <label for="user" class="form-label">Usuario *</label>
                <input id="user" formControlName="user" class="form-control" [class.is-invalid]="alquilerForm.get('user')?.invalid && alquilerForm.get('user')?.touched">
                <div class="invalid-feedback" *ngIf="alquilerForm.get('user')?.invalid && alquilerForm.get('user')?.touched">Usuario requerido</div>
              </div>
              <div class="mb-3">
                <label for="bikeId" class="form-label">Bicicleta *</label>
                <select id="bikeId" formControlName="bikeId" class="form-select" [class.is-invalid]="alquilerForm.get('bikeId')?.invalid && alquilerForm.get('bikeId')?.touched">
                  <option value="" disabled selected>Selecciona una bicicleta</option>
                  <option *ngFor="let bici of bicicletas" [value]="bici._id">{{ bici.serial }}</option>
                </select>
                <div class="invalid-feedback" *ngIf="alquilerForm.get('bikeId')?.invalid && alquilerForm.get('bikeId')?.touched">Selecciona una bicicleta</div>
              </div>
              <button class="btn btn-success w-100" type="submit" [disabled]="alquilerForm.invalid">Alquilar ahora</button>
            </form>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card shadow-sm">
          <div class="card-body">
            <h4 class="card-title mb-3"><span class="me-2">🔄</span>Devolver bicicleta</h4>
            <form [formGroup]="devolucionForm" (ngSubmit)="devolverBicicleta()" novalidate>
              <div class="mb-3">
                <label for="bookId" class="form-label">ID de alquiler *</label>
                <input id="bookId" formControlName="bookId" class="form-control" [class.is-invalid]="devolucionForm.get('bookId')?.invalid && devolucionForm.get('bookId')?.touched">
                <div class="invalid-feedback" *ngIf="devolucionForm.get('bookId')?.invalid && devolucionForm.get('bookId')?.touched">ID requerido</div>
              </div>
              <button class="btn btn-warning w-100" type="submit" [disabled]="devolucionForm.invalid">Devolver</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="mensaje" class="alert alert-info text-center mt-4">{{ mensaje }}</div>
  </div>
</div>
